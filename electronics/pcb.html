<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>PCB Design - Ecam Eurobot</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <base href="../">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="_FontAwesome/css/font-awesome.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

    </head>
    <body class="light">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li class="affix"><a href="introduction.html">Introduction</a></li><li><a href="mechanical/mechanical.html"><strong aria-hidden="true">1.</strong> Mechanical</a></li><li><ol class="section"><li><a href="mechanical/fusion.html"><strong aria-hidden="true">1.1.</strong> 3D modeling with Fusion360</a></li><li><a href="mechanical/3d-print.html"><strong aria-hidden="true">1.2.</strong> 3D printing</a></li><li><a href="mechanical/mecanum.html"><strong aria-hidden="true">1.3.</strong> Mecanum wheels</a></li><li><a href="mechanical/2018/lift.html"><strong aria-hidden="true">1.4.</strong> 2018 specifics</a></li><li><ol class="section"><li><a href="mechanical/2018/bigRobot.html"><strong aria-hidden="true">1.4.1.</strong> Block mechanism</a></li><li><a href="mechanical/2018/balls.html"><strong aria-hidden="true">1.4.2.</strong> Ball mechanism</a></li></ol></li></ol></li><li><a href="electronics/electronics.html"><strong aria-hidden="true">2.</strong> Electronics</a></li><li><ol class="section"><li><a href="electronics/actuators/actuators.html"><strong aria-hidden="true">2.1.</strong> Actuators</a></li><li><ol class="section"><li><a href="electronics/actuators/dynamixels.html"><strong aria-hidden="true">2.1.1.</strong> Dynamixels</a></li></ol></li><li><a href="electronics/sensors/sensors.html"><strong aria-hidden="true">2.2.</strong> Sensors</a></li><li><ol class="section"><li><a href="electronics/sensors/sonar.html"><strong aria-hidden="true">2.2.1.</strong> Sonar</a></li></ol></li><li><a href="electronics/pcb.html" class="active"><strong aria-hidden="true">2.3.</strong> PCB Design</a></li><li><a href="electronics/fpga.html"><strong aria-hidden="true">2.4.</strong> FPGA</a></li><li><a href="electronics/communication/communication.html"><strong aria-hidden="true">2.5.</strong> Communication</a></li><li><ol class="section"><li><a href="electronics/communication/i2c.html"><strong aria-hidden="true">2.5.1.</strong> I2C</a></li><li><a href="electronics/communication/spi.html"><strong aria-hidden="true">2.5.2.</strong> SPI</a></li><li><a href="electronics/communication/can.html"><strong aria-hidden="true">2.5.3.</strong> CAN</a></li></ol></li></ol></li><li><a href="software/software.html"><strong aria-hidden="true">3.</strong> Software</a></li><li><ol class="section"><li><a href="software/ros/ros.html"><strong aria-hidden="true">3.1.</strong> ROS</a></li><li><ol class="section"><li><a href="software/ros/install.html"><strong aria-hidden="true">3.1.1.</strong> Install</a></li><li><a href="software/ros/basics/basics.html"><strong aria-hidden="true">3.1.2.</strong> Basic concepts</a></li><li><ol class="section"><li><a href="software/ros/basics/workspace.html"><strong aria-hidden="true">3.1.2.1.</strong> Workspace setup</a></li><li><a href="software/ros/basics/packages.html"><strong aria-hidden="true">3.1.2.2.</strong> Packages</a></li><li><a href="software/ros/basics/pub.html"><strong aria-hidden="true">3.1.2.3.</strong> Publisher</a></li><li><a href="software/ros/basics/sub.html"><strong aria-hidden="true">3.1.2.4.</strong> Subscriber</a></li><li><a href="software/ros/basics/launch.html"><strong aria-hidden="true">3.1.2.5.</strong> Launchfiles</a></li><li><a href="software/ros/basics/params.html"><strong aria-hidden="true">3.1.2.6.</strong> ROS parameters</a></li></ol></li><li><a href="software/ros/advanced/advanced.html"><strong aria-hidden="true">3.1.3.</strong> Advanced concepts</a></li><li><ol class="section"><li><a href="software/ros/advanced/custom-msgs.html"><strong aria-hidden="true">3.1.3.1.</strong> Custom messages</a></li><li><a href="software/ros/advanced/model.html"><strong aria-hidden="true">3.1.3.2.</strong> Robot model</a></li><li><a href="software/ros/advanced/rviz.html"><strong aria-hidden="true">3.1.3.3.</strong> Rviz</a></li></ol></li><li><a href="software/ros/rosserial.html"><strong aria-hidden="true">3.1.4.</strong> ROS and Arduino</a></li><li><ol class="section"><li><a href="software/ros/arduino/publisher.html"><strong aria-hidden="true">3.1.4.1.</strong> Publisher</a></li><li><a href="software/ros/arduino/subscriber.html"><strong aria-hidden="true">3.1.4.2.</strong> Subscriber</a></li></ol></li><li><a href="software/ros/packages/packages.html"><strong aria-hidden="true">3.1.5.</strong> Useful packages</a></li><li><ol class="section"><li><a href="software/ros/packages/map.html"><strong aria-hidden="true">3.1.5.1.</strong> Map Server</a></li><li><a href="software/ros/packages/nav.html"><strong aria-hidden="true">3.1.5.2.</strong> Navigation stack</a></li></ol></li></ol></li><li><a href="software/image-processing.html"><strong aria-hidden="true">3.2.</strong> Image processing</a></li></ol></li><li><a href="graphic/graphic_chart.html">Appendix A: Graphic chart</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Ecam Eurobot</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="electronics/pcb.html#printed-circuit-boards" id="printed-circuit-boards"><h1>Printed Circuit Boards</h1></a>
<p>Three types of printed circuit boards were developed for our two robots. The following section presents these boards, it utilities and it conception
and gives you all the necessary elements to understand, recreate and use it.</p>
<a class="header" href="electronics/pcb.html#starting-board" id="starting-board"><h2>Starting Board</h2></a>
<p>Inspired by past version of the starting board</p>
<p>The utility of this PCB is to gather the component serving to the start sequence. Normally this is the only interface with the robot during the
competition.</p>
<p>First, we used three switches for configuring three mains points of our robot :</p>
<ul>
<li>
<p>Team configuration
We have to setup the starting side for the next match to the robot. It behaviour is different if the robot play as the green or the orange team.
Consequently, this switch set this point before the match start.</p>
</li>
<li>
<p>Strategy Configuration
It makes possible to choose between two kinds of implemented strategies before the match. For example, just before the start, we have the
possibility of aggressive or defensive strategy, function of the opponent.</p>
</li>
<li>
<p>Initialisation Switch</p>
</li>
</ul>
<p>This switch launches an initialisation sequence. After the power up of the robot and before its first move, we wanted to have the possibility to check
all different robot's systems. This switch indicates with a DEL if all systems are operational. This is a kind of automatic check list before the match
and the first move of the robot.</p>
<p>All these switches are linked to two DEL. First one to electrically confirm switches' position and the associated setting and the second one used to
have the response of the robot operating system. With these two DELs, we are sure that our robot understood all these parameters.</p>
<a class="header" href="electronics/pcb.html#useful-information" id="useful-information"><h3>Useful information</h3></a>
<ul>
<li>Correspondence</li>
</ul>
<p>Strategy</p>
<p>Pin 1 - UP   = GREEN = 0 (out raspberry) - DOWN  = RED = 1 (out raspberry)</p>
<p>Initialisation</p>
<p>Pin 2 - UP   = GREEN = 0 (out raspberry) - DOWN  = RED = 1 (out raspberry)</p>
<p>Team</p>
<p>Pin 3 - LEFT = GREEN = 1 (out raspberry) - RIGHT = RED = 1 (out raspberry)</p>
<p>Start</p>
<p>Pin 4 - piece IN     = 0 (out raspberry) - piece OUT   = 1 (out raspberry)</p>
<ul>
<li>Switch placement</li>
</ul>
<p>The emplacement is taken when the splayed side is on the right then :</p>
<ol>
<li>Strategy switch is in the upper left corner</li>
<li>Initialisation switch is on the right side of the strategy switch</li>
<li>Team switch is in the lower left corner</li>
</ol>
<p>Finally, the starter switch is plugged on the board. It consists of a relay, sending a binary information to the ROS operating system. Linked to a 0.5m
cable, this system allows to launch the match sequence pulling on it.</p>
<a class="header" href="electronics/pcb.html#motor-board" id="motor-board"><h2>Motor Board</h2></a>
<p>The goal of this board is to bring individual intelligence for every motor used on our robots. It allows to associate a microcontroller (ATmega328)
with each motor. This main component is used for two aspects : regulation and communication.</p>
<a class="header" href="electronics/pcb.html#regulation" id="regulation"><h3>Regulation</h3></a>
<p>For the smaller robot, the operating system send speed consign to the four motors. Consequently, the goal for the motor is reaching this speed in a
minimum of time and after conserving this value. The regulator implemented in the microcontrollers is Proportional Integral Derivative regulators.
It's parameters allow to influence the way to consign reaching for the motor. Thanks to it, each motor, individually can follow the ROS order with a
maximum of precision.</p>
<p>PID's parameters were found with experimentation and all sources used for implementation are in the code file.</p>
<a class="header" href="electronics/pcb.html#communication" id="communication"><h3>Communication</h3></a>
<p>As said in the previous part, this is the operating system ROS the main brain of the robot. Consequently, this brain has to communicate with its slave.
The communication protocol used on our robots is SPI. It induces that a bus has to be built between all motor and ROS. Effectively, a broker gathers
the signal for the motor but in any case each motor has to be linked to the bus. A role of the board is this connection via a SPI connector.</p>
<p>The commented code can be found in the root folder. For more information about the SPI communication, go to the SPI section.</p>
<a class="header" href="electronics/pcb.html#arduino-communication-shield---spi-broker" id="arduino-communication-shield---spi-broker"><h2>Arduino Communication Shield - SPI Broker</h2></a>
<p>Motor command communication consists of a two-level interface. ROS communicate via ROS Serial (explained in the appropriate section) implemented on an
arduino UNO and this arduino handle the communication with the four individual motors. To help for connections, we designed an arduino shield gathering
simply all SPI bus connections.</p>
<p>Again, you will find more explanation about the SPI communication in the right section and the basis of the ROS Serial use in the related section as
already said.</p>
<a class="header" href="electronics/pcb.html#annexe" id="annexe"><h2>Annexe</h2></a>
<p>All the boards adressed in this section are linked with the full Altium project in the root folder. It is the same for code and STL file for necessary 3D pieces.</p>
<a class="header" href="electronics/pcb.html#if-we-had-to-redo-it" id="if-we-had-to-redo-it"><h2>If we had to redo it</h2></a>
<p>If we had to design another robot with technologies described, there are some decision that we would change.</p>
<ul>
<li>PCB Design</li>
</ul>
<p>The ECAM installation for PCB printing is very useful for prototyping. It is not comparable with PCB that specialised company can create. So, our advice
is the following, as soon as a board is functional and definitive, send it to have a proper and reliable board. Moreover, try to reach this step as soon
as possible.</p>
<ul>
<li>Connection</li>
</ul>
<p>We have underestimated the connection on the different board. Regarding the JST connector, they are solid but hard to disconnect and cable creation is long withtout the right tool. About the 10 pins shrouded header, they are not reliable enough. Opposite to the JST, disconnection is too easy. We really advise against
its use. They were the source of a lot of problems.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="electronics/sensors/sonar.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="electronics/fpga.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="electronics/sensors/sonar.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="electronics/fpga.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        

        
        <script src="searchindex.js" type="text/javascript" charset="utf-8"></script>
        
        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

    </body>
</html>
